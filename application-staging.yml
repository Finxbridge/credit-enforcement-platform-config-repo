spring:
  profiles:
    active: staging

  datasource:
    # Prefer reading credentials from environment or secrets
    url: ${SPRING_DATASOURCE_URL:jdbc:postgresql://postgres_db:5432/staging_db}
    username: ${SPRING_DATASOURCE_USERNAME:postgres}
    password: ${SPRING_DATASOURCE_PASSWORD:}

  jpa:
    # In staging prefer validate; change to update only if intentional
    hibernate:
      ddl-auto: validate
    show-sql: false
    properties:
      hibernate:
        format_sql: false

  redis:
    host: ${REDIS_HOST:redis_cache}
    port: ${REDIS_PORT:6379}

  flyway:
    enabled: true
    baseline-on-migrate: true

# Management (actuator) - expose only health & info in staging/production
management:
  endpoints:
    web:
      exposure:
        include: health,info
  endpoint:
    health:
      show-details: when_authorized
  metrics:
    export:
      prometheus:
        enabled: ${PROMETHEUS_ENABLED:false}

# Logging defaults
logging:
  level:
    root: INFO
    com.finx: DEBUG

# Common application settings
app:
  cors:
    allowed-origins: ${CORS_ALLOWED_ORIGINS:https://staging.yourdomain.com}
  feature:
    some-feature-enabled: false

# JVM hints - read from environment (recommended via Docker Compose)
java:
  opts: ${JAVA_OPTS:-"-XX:+UseContainerSupport -XX:MaxRAMPercentage=75.0"}

# Security (placeholder; lock down endpoints in production)
security:
  basic:
    enabled: false
