spring:
  profiles:
    active: staging

  application:
    name: common-config

  # --- Cloud Config (shared for all services) ---
  cloud:
    config:
      fail-fast: true
      uri: ${CONFIG_SERVER_URI:http://config-server:8888}
      retry:
        max-attempts: 5
        initial-interval: 2000
        max-interval: 10000
        multiplier: 2

  # --- Database Configuration (common) ---
  datasource:
    url: ${SPRING_DATASOURCE_URL:jdbc:postgresql://postgres_db:5432/staging_db}
    username: ${SPRING_DATASOURCE_USERNAME:admin}
    password: ${SPRING_DATASOURCE_PASSWORD:password}
    driver-class-name: org.postgresql.Driver

  # --- Redis (common caching layer) ---
  redis:
    host: ${REDIS_HOST:redis_cache}
    port: ${REDIS_PORT:6379}

  # --- JPA / Hibernate (safe for staging) ---
  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: false
    properties:
      hibernate:
        format_sql: false

  # --- Flyway Migration (enabled) ---
  flyway:
    enabled: true
    baseline-on-migrate: true
    out-of-order: false

# --- Management & Monitoring ---
management:
  endpoints:
    web:
      exposure:
        include: health,info
  endpoint:
    health:
      show-details: when_authorized
  metrics:
    export:
      prometheus:
        enabled: ${PROMETHEUS_ENABLED:false}

# --- Logging ---
logging:
  level:
    root: INFO
    com.finx: DEBUG

# --- CORS and App Defaults ---
app:
  cors:
    allowed-origins: ${CORS_ALLOWED_ORIGINS:https://staging.yourdomain.com}

# --- JVM Optimization ---
java:
  opts: ${JAVA_OPTS:-"-XX:+UseContainerSupport -XX:MaxRAMPercentage=75.0"}


